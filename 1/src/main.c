/*
 * ExploitMe #1
 */
#include<stdio.h>
#include<string.h>

int checkpass(char *p);

int main(int argc, char **argv)
{
	printf("ExploitMe - Mission 1\n");

	if(argc != 2)
	{
		printf("Please provide a password...\n");
		return 1;
	}

	if(checkpass(argv[1]))
		printf("Access granted!\n");
	else
		printf("Access denied!\n");

	return 0;
}

int checkpass(char *p)
{
	int res;
	char pass[30];

	res = 0;

	strcpy(pass, p);

	if(strcmp(pass, "stupidlyinsecure") == 0)
		res = 1;

	return res;
}
